"use strict";var Ligature={models:{},collections:{},objects:{},views:{},singletonViews:{}};
"use strict";var LigatureUtils={eventAdder:function(t,e,r){var n=this.getNodeArray(t)||[],o=n.length;for(i=0;i<o;i++)n[i].addEventListener(e,r);return n},extendObject:function(t,e){return Object.keys(e).forEach(function(r){t[r]=e[r]}),t},getLocation:function(t){var e=t.getBoundingClientRect();return extendObject(e,{width:e.right-e.left,height:e.bottom-e.top}),e},getNodeArray:function(t){return Array.prototype.slice.apply(document.querySelectorAll(t))}};
"use strict";Ligature.models.Base=Backbone.Model.extend({urlRoot:"/api",defaults:{},initialize:function(){}}),Ligature.models.Note=Backbone.Model.extend({urlRoot:"/api",defaults:{},initialize:function(){}}),Ligature.models.Book=Backbone.Model.extend({urlRoot:"/api",defaults:{},initialize:function(){}}),Ligature.collections.Base=Backbone.Collection.extend({url:"/api",initialize:function(){},fetch:function(e){Backbone.Collection.prototype.fetch.apply(this,_.extend(e,{processData:!0}))}}),Ligature.collections.NoteCollection=Backbone.Collection.extend({url:"/api",initialize:function(){},fetch:function(e){Backbone.Collection.prototype.fetch.apply(this,_.extend(e,{processData:!0}))}}),Ligature.collections.BookCollection=Backbone.Collection.extend({url:"/api",initialize:function(){},fetch:function(e){Backbone.Collection.prototype.fetch.apply(this,_.extend(e,{processData:!0}))}});
"use strict";Ligature.viewManager=Ligature.models.Base.extend({initialize:function(){this.attributes={notesLoaded:!1,dirtyEdits:!1,activeBook:!1,activeNote:!1,editingMode:"overview"}},changeMode:function(e){"overview"===e||"editing"===e||console.warn(e+" isn't a valid editing mode!")}}),Ligature.views.Base=Backbone.View.extend({className:"",template:"\n      <div></div>\n    ",events:{},initialize:function(e){this.render()},render:function(){return this.$el.html(this.template),this}}),Ligature.views.Sidebar=Backbone.View.extend({className:"sidebar",header:!1,booklist:!1,template:"",events:{},initialize:function(e){this.header=new Ligature.views.Header,this.booklist=new Ligature.views.BookList,this.render()},render:function(){return this.$el.html(this.template),this.$el.append(this.header.render().$el),this.$el.append(this.booklist.render().$el),this}}),Ligature.views.Header=Backbone.View.extend({tagName:"header",toolbar:!1,template:'\n      <a href="/">\n        Ligature\n      </a>\n    ',events:{},initialize:function(e){this.toolbar=new Ligature.views.Toolbar,this.render()},render:function(){return this.$el.html(this.template),this.$el.append(this.toolbar.render().$el),this}}),Ligature.views.Toolbar=Backbone.View.extend({className:"toolbar",template:'\n      <div>\n        <button class="add">add</button>\n        <button class="collapse">collapse</button>\n        <button class="search">search</button>\n\n        <input class="searchbar" type="text" placeholder="search"></input>\n      </div>\n    ',events:{"click .add":"addClick","click .collapse":"collapseClick","click .search":"searchClick","keydown .searchbar":"searchInput"},addClick:function(e){},collapseClick:function(e){},searchClick:function(e){},searchInput:function(e){},initialize:function(e){this.render()},render:function(){return this.$el.html(this.template),this}}),Ligature.views.BookList=Backbone.View.extend({className:"booklist",books:!1,template:"",events:{},initialize:function(e){this.books=Ligature.objects.books.map(function(e){return new Ligature.views.BookListItem({model:e})}),this.render()},render:function(){var e=this;return this.$el.html(this.template),this.books.forEach(function(t){return e.$el.append(t.render().$el)}),this}}),Ligature.views.BookListItem=Backbone.View.extend({className:"booklistItem",expanded:!1,notelist:!1,template:'\n      <div class="bookname">\n      </div>\n\n      <div class="lastEdited">\n      </div>\n      <div class="noteCount">\n      </div>\n\n      <div class="notes expanded'+(void 0).expanded+'">\n      </div>\n    ',events:{click:"select"},initialize:function(e){this.notelist=new Ligature.views.NoteList({model:this.model}),this.render()},select:function(e){this.expanded=!this.expanded,this.render()},render:function(){return this.$el.html(this.template),this.$(".bookname").html(this.model.get("name")),this.$(".lastEdited").html(this.model.get("notes").first().get("timestamp")),this.$(".noteCount").html(this.model.get("notes").length),this.$el.append(this.notelist.render().$el),this}}),Ligature.views.NoteList=Backbone.View.extend({className:"notelist",notes:!1,template:"",events:{},initialize:function(e){this.notes=Ligature.objects.notes.map(function(e){return new Ligature.views.NoteListItem({model:e})}),this.render()},render:function(){var e=this;return this.$el.html(this.template),this.books.forEach(function(t){return e.$el.append(t.render().$el)}),this}}),Ligature.views.NoteListItem=Backbone.View.extend({className:"notelistItem",buttonset:!1,template:'\n      <div class="title">\n      </div>\n      <div class="firstline">\n      </div>\n\n      <div class="buttonset">\n      </div>\n    ',events:{click:"select"},initialize:function(e){this.buttonset=new Ligature.views.NoteButtonSet,this.render()},select:function(e){Ligature.viewManager.set("activeNote",this.model)},render:function(){return this.$el.html(this.template),this.$(".title").html(this.model.get("title")),this.$(".firstline").html(this.model.get("content").substr(0,100)),this.$(".buttonset").html(this.buttonset.render().$el),this}}),Ligature.views.NoteButtonSet=Backbone.View.extend({className:"notebuttonset",template:'\n      <button class="back">back</button>\n      <button class="copy">copy</button>\n      <button class="delete">delete</button>\n    ',events:{"click .back":"backClick","click .copy":"copyClick","click .delete":"deleteClick"},initialize:function(e){this.render()},render:function(){return this.$el.html(this.template),this}}),Ligature.views.Editor=Backbone.View.extend({id:"editor",buttonset:!1,template:'\n      <button class=\'modeSwitch\'>mode</button>\n      <div class="buttonset">\n      </div>\n\n      <div class="titlebar">\n      </div>\n\n      <div class="metadatabar">\n        <span class="lastEdited"></span> |\n        <span class="words"></span> |\n        <span class="chars"></span>\n      </div>\n\n      <textarea class="content">\n      </textarea>\n    ',events:{"click .modeSwitch":"modeSwitch","click .titlebar":"setTitle"},initialize:function(e){this.buttonset=new Ligature.views.NoteButtonSet,this.render()},render:function(){this.$el.html(this.template);var e=Ligature.viewManager.get("activeNote");return this.$(".titlebar").html(e.get("title")),this.$(".content").val(e.get("content")),this.$(".lastEdited").html(e.get("timestamp")),this.$(".words").html(e.get("content").split(" ").length),this.$(".chars").html(e.get("content").length),this.$(".buttonset").html(this.buttonset.render().$el),this}}),Ligature.views.Modal=Backbone.View.extend({id:"modal",template:'\n      <div class="copy">\n      </div>\n\n      <input class="modalInput"></input>\n\n      <button class="bad">Cancel</button>\n      <button class="good">Ok</button>\n    ',events:{"click .good":"goodClick","click .bad":"badClick"},initialize:function(e){this.render()},goodClick:function(e){},badClick:function(e){},alert:function(e){},confirm:function(e){},prompt:function(e){},_call:function(e,t,i,n,s){},render:function(){return this.$el.html(this.template),this}}),Ligature.views.App=Backbone.View.extend({template:"",sidebar:!1,editor:!1,events:{},initialize:function(e){this.sidebar=new Ligature.views.Sidebar,this.editor=new Ligature.views.Editor,this.modal=new Ligature.views.Modal,this.render()},render:function(){return this.$el.html(this.template),this.$el.append(this.sidebar.render().$el),this.$el.append(this.editor.render().$el),this.$el.append(this.modal.render().$el),this}});
"use strict";Ligature.Router=Backbone.Router.extend({});
"use strict";Ligature.init=function(){Ligature.objects.notes=new Ligature.collections.NoteCollection,Ligature.objects.books=new Ligature.collections.BookCollection,Ligature.singletonViews.app=new Ligature.views.App,Ligature.core=new Ligature.viewManager,Ligature.router=new Ligature.Router,$("#content").append(Ligature.singletonViews.app.render().$el),Ligature.objects.notes.fetch(),console.info("Ligature initialized")},Ligature.init();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluaXQuanMiLCJ1dGlscy5qcyIsIm1vZGVscy5qcyIsInZpZXdzLmpzIiwicm91dGVyLmpzIiwibWFpbi5qcyJdLCJuYW1lcyI6WyJMaWdhdHVyZSIsIm1vZGVscyIsImNvbGxlY3Rpb25zIiwib2JqZWN0cyIsInZpZXdzIiwiTGlnYXR1cmVVdGlscyIsInNlbGVjdG9yIiwiZXZlbnROYW1lIiwiY2FsbGJhY2siLCJ0YXJnZXRzIiwidGhpcyIsImdldE5vZGVBcnJheSIsImV2ZW50QWRkZXIiLCJsZW5ndGgiLCJ0TGVuZ3RoIiwiaSIsImFkZEV2ZW50TGlzdGVuZXIiLCJleHRlbmRPYmplY3QiLCJvYmoiLCJlbCIsImZvckVhY2giLCJrZXkiLCJnZXRMb2NhdGlvbiIsImJvdW5kaW5nQ2xpZW50UmVjdCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsImxlZnQiLCJ3aWR0aCIsInJpZ2h0IiwiaWRlbnRpZmllciIsIkFycmF5IiwicHJvdG90eXBlIiwic2xpY2UiLCJhcHBseSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsIkJhc2UiLCJCYWNrYm9uZSIsIk1vZGVsIiwiZXh0ZW5kIiwidXJsUm9vdCIsImluaXRpYWxpemUiLCJOb3RlIiwiQm9vayIsIkNvbGxlY3Rpb24iLCJ1cmwiLCJmZXRjaCIsIm9wdGlvbnMiLCJfIiwicHJvY2Vzc0RhdGEiLCJOb3RlQ29sbGVjdGlvbiIsIkJvb2tDb2xsZWN0aW9uIiwidmlld01hbmFnZXIiLCJhdHRyaWJ1dGVzIiwiZGlydHlFZGl0cyIsImFjdGl2ZU5vdGUiLCJjaGFuZ2VNb2RlIiwibW9kZSIsImNvbnNvbGUiLCJ3YXJuIiwiVmlldyIsImNsYXNzTmFtZSIsImV2ZW50cyIsImF0dHJzIiwicmVuZGVyIiwiJGVsIiwiaHRtbCIsInRlbXBsYXRlIiwiU2lkZWJhciIsImhlYWRlciIsImJvb2tsaXN0IiwiSGVhZGVyIiwiQm9va0xpc3QiLCJhcHBlbmQiLCJ0YWdOYW1lIiwidG9vbGJhciIsIlRvb2xiYXIiLCJzZWFyY2hJbnB1dCIsImNsaWNrIC5jb2xsYXBzZSIsImtleWRvd24gLnNlYXJjaGJhciIsImV2dCIsImNvbGxhcHNlQ2xpY2siLCJzZWFyY2hDbGljayIsImJvb2tzIiwiQm9va0xpc3RJdGVtIiwibW9kZWwiLCJib29rTW9kZWwiLCJub3RlbGlzdCIsIl90aGlzIiwiYm9va1ZpZXciLCJleHBhbmRlZCIsInVuZGVmaW5lZCIsImNsaWNrIiwiTm90ZUxpc3QiLCJub3RlcyIsIiQiLCJnZXQiLCJmaXJzdCIsIm1hcCIsIm5vdGVNb2RlbCIsIk5vdGVMaXN0SXRlbSIsIl90aGlzMiIsInNlbGVjdCIsIm5vdGVWaWV3IiwiYnV0dG9uc2V0IiwiTm90ZUJ1dHRvblNldCIsInNldCIsIkVkaXRvciIsInN1YnN0ciIsImNsaWNrIC5iYWNrIiwiY2xpY2sgLmNvcHkiLCJjbGljayAuZGVsZXRlIiwiY29uZmlybSIsImNsaWNrIC5tb2RlU3dpdGNoIiwicHJvbXB0Iiwic2lkZWJhciIsImVkaXRvciIsInZhbCIsInNwbGl0IiwiaWQiLCJjbGljayAuZ29vZCIsImNsaWNrIC5iYWQiLCJnb29kQ2xpY2siLCJiYWRDbGljayIsImFsZXJ0IiwiX2NhbGwiLCJjb3B5Iiwic2hvd0lucHV0Iiwic2hvd0JhZCIsImdvb2RDYWxsYmFjayIsImJhZENhbGxiYWNrIiwiQXBwIiwibW9kYWwiLCJNb2RhbCIsIlJvdXRlciIsImluaXQiLCJzaW5nbGV0b25WaWV3cyIsImFwcCIsImNvcmUiLCJyb3V0ZXIiXSwibWFwcGluZ3MiOiJZQUFBLElBQU1BLFdBQUFBLFVBRUZDLGVBRUFDLFdBRUFDLFNBRUFDO1lDUkosSUFBTUMsZ0JBQUFBLFdBQUFBLFNBQWdCQyxFQUFBQyxFQUFBQyxHQUdkLEdBQUlDLEdBQVVDLEtBQUtDLGFBQWFMLE9BRHBDTSxFQUFZSCxFQUFBSSxNQUNSLEtBQ0lDLEVBQUFBLEVBQUFBLEVBQVVMLEVBQVFJLElBR2xCSixFQUFRTSxHQUFHQyxpQkFBaUJULEVBQVdDLEVBQzFDLE9BQUFDLElBR0pRLGFB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QUFTSSxNQUFNZ0ksTUFDaEMxSCxLQUFLcUQsVUFHVEEsT0FBUSxXQU1KLE1BTEFyRCxNQUFLc0QsSUFBSUMsS0FBS3ZELEtBQUt3RCxVQUNuQnhELEtBQUtzRCxJQUFJUSxPQUFPOUQsS0FBS3dHLFFBQVFuRCxTQUFTQyxLQUN0Q3RELEtBQUtzRCxJQUFJUSxPQUFPOUQsS0FBS3lHLE9BQU9wRCxTQUFTQyxLQUNyQ3RELEtBQUtzRCxJQUFJUSxPQUFPOUQsS0FBS3lILE1BQU1wRSxTQUFTQyxLQUU3QnREO1lDOWJmVixVQUFTcUksT0FBU2pHLFNBQVNpRyxPQUFPL0Y7WUNBbEN0QyxVQUFTc0ksS0FBTyxXQVladEksU0FBU0csUUFBUTBGLE1BQVEsR0FBSTdGLFVBQVNFLFlBQVkrQyxlQURsRGpELFNBQUFHLFFBQUErRSxNQUFBLEdBQUFsRixVQUFBRSxZQUFBZ0QsZUFLQWxELFNBQVN1SSxlQUFlQyxJQUFNLEdBQUl4SSxVQUFTSSxNQUFNOEgsSUFEakRsSSxTQUFBeUksS0FBQSxHQUFBekksVUFBQW1ELFlBS0FuRCxTQUFTMEksT0FBUyxHQUFJMUksVUFBU3FJLE9BRy9CdkMsRUFBRSxZQUFZdEIsT0FBT3hFLFNBQVN1SSxlQUFlQyxJQUFJekUsU0FBU0MsS0FHMURoRSxTQUFTRyxRQUFRMEYsTUFBTWhELFFBQXZCN0MsUUFBQUEsS0FBU0cseUJBTWJILFNBQVNzSSIsImZpbGUiOiJqcy9tYWluLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IExpZ2F0dXJlID0ge1xuXG4gICAgbW9kZWxzOiB7fSxcblxuICAgIGNvbGxlY3Rpb25zOiB7fSxcblxuICAgIG9iamVjdHM6IHt9LFxuXG4gICAgdmlld3M6IHt9LFxuXG4gICAgc2luZ2xldG9uVmlld3M6IHt9XG5cbn07XG4iLCJjb25zdCBMaWdhdHVyZVV0aWxzID0ge1xuXG4gICAgZXZlbnRBZGRlcjogZnVuY3Rpb24oc2VsZWN0b3IsIGV2ZW50TmFtZSwgY2FsbGJhY2spIHtcbiAgICAgICAgdmFyIHRhcmdldHMgPSB0aGlzLmdldE5vZGVBcnJheShzZWxlY3RvcikgfHwgW10sXG4gICAgICAgICAgICB0TGVuZ3RoID0gdGFyZ2V0cy5sZW5ndGg7XG5cbiAgICAgICAgZm9yIChpID0gMDsgaSA8IHRMZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdGFyZ2V0c1tpXS5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgY2FsbGJhY2spO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRhcmdldHM7XG4gICAgfSxcblxuICAgIGV4dGVuZE9iamVjdDogZnVuY3Rpb24ob2JqLCBlbCkge1xuXG4gICAgICAgIE9iamVjdC5rZXlzKGVsKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkge1xuICAgICAgICAgICAgb2JqW2tleV0gPSBlbFtrZXldO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gb2JqO1xuXG4gICAgfSxcblxuICAgIGdldExvY2F0aW9uOiBmdW5jdGlvbihlbCkge1xuXG4gICAgICAgIHZhciBib3VuZGluZ0NsaWVudFJlY3QgPSBlbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgICAgICBleHRlbmRPYmplY3QoYm91bmRpbmdDbGllbnRSZWN0LCB7XG4gICAgICAgICAgICB3aWR0aDogYm91bmRpbmdDbGllbnRSZWN0LnJpZ2h0IC0gYm91bmRpbmdDbGllbnRSZWN0LmxlZnQsXG4gICAgICAgICAgICBoZWlnaHQ6IGJvdW5kaW5nQ2xpZW50UmVjdC5ib3R0b20gLSBib3VuZGluZ0NsaWVudFJlY3QudG9wXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBib3VuZGluZ0NsaWVudFJlY3Q7XG5cbiAgICB9LFxuXG4gICAgZ2V0Tm9kZUFycmF5OiBmdW5jdGlvbihpZGVudGlmaWVyKSB7XG4gICAgICAgIHJldHVybiBBcnJheS5wcm90b3R5cGUuc2xpY2UuYXBwbHkoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChpZGVudGlmaWVyKSk7XG4gICAgfVxuXG59O1xuIiwiLyogTU9ERUxTICovXG5cbkxpZ2F0dXJlLm1vZGVscy5CYXNlID0gQmFja2JvbmUuTW9kZWwuZXh0ZW5kKHtcblxuICAgIHVybFJvb3Q6ICcvYXBpJyxcblxuICAgIGRlZmF1bHRzOiB7XG4gICAgICAgIC8vIGRlZmF1bHRzXG4gICAgfSxcblxuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBkZWZhdWx0c1xuICAgIH0sXG5cbn0pO1xuXG5MaWdhdHVyZS5tb2RlbHMuTm90ZSA9IEJhY2tib25lLk1vZGVsLmV4dGVuZCh7XG5cbiAgICB1cmxSb290OiAnL2FwaScsXG5cbiAgICBkZWZhdWx0czoge1xuICAgICAgICAvLyBkZWZhdWx0c1xuICAgIH0sXG5cbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gZGVmYXVsdHNcbiAgICB9LFxuXG59KTtcblxuTGlnYXR1cmUubW9kZWxzLkJvb2sgPSBCYWNrYm9uZS5Nb2RlbC5leHRlbmQoe1xuXG4gICAgdXJsUm9vdDogJy9hcGknLFxuXG4gICAgZGVmYXVsdHM6IHtcbiAgICAgICAgLy8gZGVmYXVsdHNcbiAgICB9LFxuXG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIGRlZmF1bHRzXG4gICAgfSxcblxufSk7XG5cbi8qIENPTExFQ1RJT05TICovXG5cbkxpZ2F0dXJlLmNvbGxlY3Rpb25zLkJhc2UgPSBCYWNrYm9uZS5Db2xsZWN0aW9uLmV4dGVuZCh7XG5cbiAgICB1cmw6ICcvYXBpJyxcblxuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBkZWZhdWx0c1xuICAgIH0sXG5cbiAgICBmZXRjaDogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICBCYWNrYm9uZS5Db2xsZWN0aW9uLnByb3RvdHlwZS5mZXRjaC5hcHBseSh0aGlzLCBfLmV4dGVuZChvcHRpb25zLCB7XG4gICAgICAgICAgICBwcm9jZXNzRGF0YTogdHJ1ZVxuICAgICAgICB9KSk7XG4gICAgfVxuXG59KTtcblxuTGlnYXR1cmUuY29sbGVjdGlvbnMuTm90ZUNvbGxlY3Rpb24gPSBCYWNrYm9uZS5Db2xsZWN0aW9uLmV4dGVuZCh7XG5cbiAgICB1cmw6ICcvYXBpJyxcblxuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBkZWZhdWx0c1xuICAgIH0sXG5cbiAgICBmZXRjaDogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICBCYWNrYm9uZS5Db2xsZWN0aW9uLnByb3RvdHlwZS5mZXRjaC5hcHBseSh0aGlzLCBfLmV4dGVuZChvcHRpb25zLCB7XG4gICAgICAgICAgICBwcm9jZXNzRGF0YTogdHJ1ZVxuICAgICAgICB9KSk7XG4gICAgfVxuXG59KTtcblxuTGlnYXR1cmUuY29sbGVjdGlvbnMuQm9va0NvbGxlY3Rpb24gPSBCYWNrYm9uZS5Db2xsZWN0aW9uLmV4dGVuZCh7XG5cbiAgICB1cmw6ICcvYXBpJyxcblxuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBkZWZhdWx0c1xuICAgIH0sXG5cbiAgICBmZXRjaDogZnVuY3Rpb24ob3B0aW9ucykge1xuICAgICAgICBCYWNrYm9uZS5Db2xsZWN0aW9uLnByb3RvdHlwZS5mZXRjaC5hcHBseSh0aGlzLCBfLmV4dGVuZChvcHRpb25zLCB7XG4gICAgICAgICAgICBwcm9jZXNzRGF0YTogdHJ1ZVxuICAgICAgICB9KSk7XG4gICAgfVxuXG59KTtcbiIsIi8qIFZJRVcgTUFOQUdFUiAqL1xuXG5MaWdhdHVyZS52aWV3TWFuYWdlciA9IExpZ2F0dXJlLm1vZGVscy5CYXNlLmV4dGVuZCh7XG5cbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVzID0ge1xuICAgICAgICAgICAgbm90ZXNMb2FkZWQ6IGZhbHNlLFxuICAgICAgICAgICAgZGlydHlFZGl0czogZmFsc2UsXG5cbiAgICAgICAgICAgIGFjdGl2ZUJvb2s6IGZhbHNlLFxuICAgICAgICAgICAgYWN0aXZlTm90ZTogZmFsc2UsXG5cbiAgICAgICAgICAgIGVkaXRpbmdNb2RlOiAnb3ZlcnZpZXcnXG4gICAgICAgIH07XG4gICAgfSxcblxuICAgIGNoYW5nZU1vZGU6IGZ1bmN0aW9uKG1vZGUpIHtcbiAgICAgICAgaWYgKG1vZGUgPT09ICdvdmVydmlldycpIHtcbiAgICAgICAgICAgIC8vIGRvIHRoaW5nc1xuICAgICAgICB9IGVsc2UgaWYgKG1vZGUgPT09ICdlZGl0aW5nJykge1xuICAgICAgICAgICAgLy8gZG8gdGhpbmdzXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oYCR7bW9kZX0gaXNuJ3QgYSB2YWxpZCBlZGl0aW5nIG1vZGUhYCk7XG4gICAgICAgIH1cbiAgICB9XG5cbn0pO1xuXG4vKiBWSUVXUyAqL1xuXG5MaWdhdHVyZS52aWV3cy5CYXNlID0gQmFja2JvbmUuVmlldy5leHRlbmQoe1xuXG4gICAgY2xhc3NOYW1lOiAnJyxcblxuICAgIHRlbXBsYXRlOiBgXG4gICAgICA8ZGl2PjwvZGl2PlxuICAgIGAsXG5cbiAgICBldmVudHM6IHt9LFxuXG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oYXR0cnMpIHtcbiAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICB9LFxuXG4gICAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy4kZWwuaHRtbCh0aGlzLnRlbXBsYXRlKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG59KTtcblxuTGlnYXR1cmUudmlld3MuU2lkZWJhciA9IEJhY2tib25lLlZpZXcuZXh0ZW5kKHtcblxuICAgIGNsYXNzTmFtZTogJ3NpZGViYXInLFxuICAgIGhlYWRlcjogZmFsc2UsXG4gICAgYm9va2xpc3Q6IGZhbHNlLFxuXG4gICAgdGVtcGxhdGU6ICcnLFxuXG4gICAgZXZlbnRzOiB7fSxcblxuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKGF0dHJzKSB7XG4gICAgICAgIHRoaXMuaGVhZGVyID0gbmV3IExpZ2F0dXJlLnZpZXdzLkhlYWRlcigpO1xuICAgICAgICB0aGlzLmJvb2tsaXN0ID0gbmV3IExpZ2F0dXJlLnZpZXdzLkJvb2tMaXN0KCk7XG5cbiAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICB9LFxuXG4gICAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy4kZWwuaHRtbCh0aGlzLnRlbXBsYXRlKTtcbiAgICAgICAgdGhpcy4kZWwuYXBwZW5kKHRoaXMuaGVhZGVyLnJlbmRlcigpLiRlbCk7XG4gICAgICAgIHRoaXMuJGVsLmFwcGVuZCh0aGlzLmJvb2tsaXN0LnJlbmRlcigpLiRlbCk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG59KTtcblxuTGlnYXR1cmUudmlld3MuSGVhZGVyID0gQmFja2JvbmUuVmlldy5leHRlbmQoe1xuXG4gICAgdGFnTmFtZTogJ2hlYWRlcicsXG4gICAgdG9vbGJhcjogZmFsc2UsXG5cbiAgICB0ZW1wbGF0ZTogYFxuICAgICAgPGEgaHJlZj1cIi9cIj5cbiAgICAgICAgTGlnYXR1cmVcbiAgICAgIDwvYT5cbiAgICBgLFxuXG4gICAgZXZlbnRzOiB7fSxcblxuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKGF0dHJzKSB7XG4gICAgICAgIHRoaXMudG9vbGJhciA9IG5ldyBMaWdhdHVyZS52aWV3cy5Ub29sYmFyKCk7XG4gICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgfSxcblxuICAgIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuJGVsLmh0bWwodGhpcy50ZW1wbGF0ZSk7XG4gICAgICAgIHRoaXMuJGVsLmFwcGVuZCh0aGlzLnRvb2xiYXIucmVuZGVyKCkuJGVsKTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbn0pO1xuXG5MaWdhdHVyZS52aWV3cy5Ub29sYmFyID0gQmFja2JvbmUuVmlldy5leHRlbmQoe1xuXG4gICAgY2xhc3NOYW1lOiAndG9vbGJhcicsXG5cbiAgICB0ZW1wbGF0ZTogYFxuICAgICAgPGRpdj5cbiAgICAgICAgPGJ1dHRvbiBjbGFzcz1cImFkZFwiPmFkZDwvYnV0dG9uPlxuICAgICAgICA8YnV0dG9uIGNsYXNzPVwiY29sbGFwc2VcIj5jb2xsYXBzZTwvYnV0dG9uPlxuICAgICAgICA8YnV0dG9uIGNsYXNzPVwic2VhcmNoXCI+c2VhcmNoPC9idXR0b24+XG5cbiAgICAgICAgPGlucHV0IGNsYXNzPVwic2VhcmNoYmFyXCIgdHlwZT1cInRleHRcIiBwbGFjZWhvbGRlcj1cInNlYXJjaFwiPjwvaW5wdXQ+XG4gICAgICA8L2Rpdj5cbiAgICBgLFxuXG4gICAgZXZlbnRzOiB7XG4gICAgICAgICdjbGljayAuYWRkJzogJ2FkZENsaWNrJyxcbiAgICAgICAgJ2NsaWNrIC5jb2xsYXBzZSc6ICdjb2xsYXBzZUNsaWNrJyxcbiAgICAgICAgJ2NsaWNrIC5zZWFyY2gnOiAnc2VhcmNoQ2xpY2snLFxuICAgICAgICAna2V5ZG93biAuc2VhcmNoYmFyJzogJ3NlYXJjaElucHV0J1xuICAgIH0sXG5cbiAgICBhZGRDbGljazogZnVuY3Rpb24oZXZ0KSB7XG5cbiAgICB9LFxuXG4gICAgY29sbGFwc2VDbGljazogZnVuY3Rpb24oZXZ0KSB7XG5cbiAgICB9LFxuXG4gICAgc2VhcmNoQ2xpY2s6IGZ1bmN0aW9uKGV2dCkge1xuXG4gICAgfSxcblxuICAgIHNlYXJjaElucHV0OiBmdW5jdGlvbihldnQpIHtcblxuICAgIH0sXG5cbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihhdHRycykge1xuICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgIH0sXG5cbiAgICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLiRlbC5odG1sKHRoaXMudGVtcGxhdGUpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbn0pO1xuXG5MaWdhdHVyZS52aWV3cy5Cb29rTGlzdCA9IEJhY2tib25lLlZpZXcuZXh0ZW5kKHtcblxuICAgIGNsYXNzTmFtZTogJ2Jvb2tsaXN0JyxcbiAgICBib29rczogZmFsc2UsXG5cbiAgICB0ZW1wbGF0ZTogJycsXG5cbiAgICBldmVudHM6IHt9LFxuXG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oYXR0cnMpIHtcbiAgICAgICAgdGhpcy5ib29rcyA9IExpZ2F0dXJlLm9iamVjdHMuYm9va3MubWFwKGJvb2tNb2RlbCA9PlxuICAgICAgICAgICAgbmV3IExpZ2F0dXJlLnZpZXdzLkJvb2tMaXN0SXRlbSh7IG1vZGVsOiBib29rTW9kZWwgfSlcbiAgICAgICAgKTtcblxuICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgIH0sXG5cbiAgICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLiRlbC5odG1sKHRoaXMudGVtcGxhdGUpO1xuICAgICAgICB0aGlzLmJvb2tzLmZvckVhY2goYm9va1ZpZXcgPT4gdGhpcy4kZWwuYXBwZW5kKGJvb2tWaWV3LnJlbmRlcigpLiRlbCkpO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxufSk7XG5cbkxpZ2F0dXJlLnZpZXdzLkJvb2tMaXN0SXRlbSA9IEJhY2tib25lLlZpZXcuZXh0ZW5kKHtcblxuICAgIGNsYXNzTmFtZTogJ2Jvb2tsaXN0SXRlbScsXG4gICAgZXhwYW5kZWQ6IGZhbHNlLFxuICAgIG5vdGVsaXN0OiBmYWxzZSxcblxuICAgIHRlbXBsYXRlOiBgXG4gICAgICA8ZGl2IGNsYXNzPVwiYm9va25hbWVcIj5cbiAgICAgIDwvZGl2PlxuXG4gICAgICA8ZGl2IGNsYXNzPVwibGFzdEVkaXRlZFwiPlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2IGNsYXNzPVwibm90ZUNvdW50XCI+XG4gICAgICA8L2Rpdj5cblxuICAgICAgPGRpdiBjbGFzcz1cIm5vdGVzIGV4cGFuZGVkJHt0aGlzLmV4cGFuZGVkfVwiPlxuICAgICAgPC9kaXY+XG4gICAgYCxcblxuICAgIGV2ZW50czoge1xuICAgICAgICAnY2xpY2snOiAnc2VsZWN0J1xuICAgIH0sXG5cbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihhdHRycykge1xuICAgICAgICB0aGlzLm5vdGVsaXN0ID0gbmV3IExpZ2F0dXJlLnZpZXdzLk5vdGVMaXN0KHsgbW9kZWw6IHRoaXMubW9kZWwgfSk7XG4gICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgfSxcblxuICAgIHNlbGVjdDogZnVuY3Rpb24oZXZ0KSB7XG4gICAgICAgIHRoaXMuZXhwYW5kZWQgPSAhdGhpcy5leHBhbmRlZDtcbiAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICB9LFxuXG4gICAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy4kZWwuaHRtbCh0aGlzLnRlbXBsYXRlKTtcblxuICAgICAgICB0aGlzLiQoJy5ib29rbmFtZScpLmh0bWwodGhpcy5tb2RlbC5nZXQoJ25hbWUnKSk7XG4gICAgICAgIHRoaXMuJCgnLmxhc3RFZGl0ZWQnKS5odG1sKHRoaXMubW9kZWwuZ2V0KCdub3RlcycpLmZpcnN0KCkuZ2V0KCd0aW1lc3RhbXAnKSk7XG4gICAgICAgIHRoaXMuJCgnLm5vdGVDb3VudCcpLmh0bWwodGhpcy5tb2RlbC5nZXQoJ25vdGVzJykubGVuZ3RoKTtcbiAgICAgICAgdGhpcy4kZWwuYXBwZW5kKHRoaXMubm90ZWxpc3QucmVuZGVyKCkuJGVsKTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbn0pO1xuXG5MaWdhdHVyZS52aWV3cy5Ob3RlTGlzdCA9IEJhY2tib25lLlZpZXcuZXh0ZW5kKHtcblxuICAgIGNsYXNzTmFtZTogJ25vdGVsaXN0JyxcbiAgICBub3RlczogZmFsc2UsXG5cbiAgICB0ZW1wbGF0ZTogJycsXG5cbiAgICBldmVudHM6IHt9LFxuXG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oYXR0cnMpIHtcbiAgICAgICAgdGhpcy5ub3RlcyA9IExpZ2F0dXJlLm9iamVjdHMubm90ZXMubWFwKG5vdGVNb2RlbCA9PlxuICAgICAgICAgICAgbmV3IExpZ2F0dXJlLnZpZXdzLk5vdGVMaXN0SXRlbSh7IG1vZGVsOiBub3RlTW9kZWwgfSlcbiAgICAgICAgKTtcblxuICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgIH0sXG5cbiAgICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLiRlbC5odG1sKHRoaXMudGVtcGxhdGUpO1xuICAgICAgICB0aGlzLmJvb2tzLmZvckVhY2gobm90ZVZpZXcgPT4gdGhpcy4kZWwuYXBwZW5kKG5vdGVWaWV3LnJlbmRlcigpLiRlbCkpO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxufSk7XG5cbkxpZ2F0dXJlLnZpZXdzLk5vdGVMaXN0SXRlbSA9IEJhY2tib25lLlZpZXcuZXh0ZW5kKHtcblxuICAgIGNsYXNzTmFtZTogJ25vdGVsaXN0SXRlbScsXG4gICAgYnV0dG9uc2V0OiBmYWxzZSxcblxuICAgIHRlbXBsYXRlOiBgXG4gICAgICA8ZGl2IGNsYXNzPVwidGl0bGVcIj5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdiBjbGFzcz1cImZpcnN0bGluZVwiPlxuICAgICAgPC9kaXY+XG5cbiAgICAgIDxkaXYgY2xhc3M9XCJidXR0b25zZXRcIj5cbiAgICAgIDwvZGl2PlxuICAgIGAsXG5cbiAgICBldmVudHM6IHtcbiAgICAgICAgJ2NsaWNrJzogJ3NlbGVjdCdcbiAgICB9LFxuXG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oYXR0cnMpIHtcbiAgICAgICAgdGhpcy5idXR0b25zZXQgPSBuZXcgTGlnYXR1cmUudmlld3MuTm90ZUJ1dHRvblNldCgpO1xuICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgIH0sXG5cbiAgICBzZWxlY3Q6IGZ1bmN0aW9uKGV2dCkge1xuICAgICAgICBMaWdhdHVyZS52aWV3TWFuYWdlci5zZXQoJ2FjdGl2ZU5vdGUnLCB0aGlzLm1vZGVsKTtcbiAgICB9LFxuXG4gICAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICAgICAgdGhpcy4kZWwuaHRtbCh0aGlzLnRlbXBsYXRlKTtcblxuICAgICAgICB0aGlzLiQoJy50aXRsZScpLmh0bWwodGhpcy5tb2RlbC5nZXQoJ3RpdGxlJykpO1xuICAgICAgICB0aGlzLiQoJy5maXJzdGxpbmUnKS5odG1sKHRoaXMubW9kZWwuZ2V0KCdjb250ZW50Jykuc3Vic3RyKDAsIDEwMCkpO1xuICAgICAgICB0aGlzLiQoJy5idXR0b25zZXQnKS5odG1sKHRoaXMuYnV0dG9uc2V0LnJlbmRlcigpLiRlbCk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG59KTtcblxuTGlnYXR1cmUudmlld3MuTm90ZUJ1dHRvblNldCA9IEJhY2tib25lLlZpZXcuZXh0ZW5kKHtcblxuICAgIGNsYXNzTmFtZTogJ25vdGVidXR0b25zZXQnLFxuXG4gICAgdGVtcGxhdGU6IGBcbiAgICAgIDxidXR0b24gY2xhc3M9XCJiYWNrXCI+YmFjazwvYnV0dG9uPlxuICAgICAgPGJ1dHRvbiBjbGFzcz1cImNvcHlcIj5jb3B5PC9idXR0b24+XG4gICAgICA8YnV0dG9uIGNsYXNzPVwiZGVsZXRlXCI+ZGVsZXRlPC9idXR0b24+XG4gICAgYCxcblxuICAgIGV2ZW50czoge1xuICAgICAgICAnY2xpY2sgLmJhY2snOiAnYmFja0NsaWNrJyxcbiAgICAgICAgJ2NsaWNrIC5jb3B5JzogJ2NvcHlDbGljaycsXG4gICAgICAgICdjbGljayAuZGVsZXRlJzogJ2RlbGV0ZUNsaWNrJ1xuICAgIH0sXG5cbiAgICBpbml0aWFsaXplOiBmdW5jdGlvbihhdHRycykge1xuICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgIH0sXG5cbiAgICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLiRlbC5odG1sKHRoaXMudGVtcGxhdGUpO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbn0pO1xuXG5MaWdhdHVyZS52aWV3cy5FZGl0b3IgPSBCYWNrYm9uZS5WaWV3LmV4dGVuZCh7XG5cbiAgICBpZDogJ2VkaXRvcicsXG4gICAgYnV0dG9uc2V0OiBmYWxzZSxcblxuICAgIHRlbXBsYXRlOiBgXG4gICAgICA8YnV0dG9uIGNsYXNzPSdtb2RlU3dpdGNoJz5tb2RlPC9idXR0b24+XG4gICAgICA8ZGl2IGNsYXNzPVwiYnV0dG9uc2V0XCI+XG4gICAgICA8L2Rpdj5cblxuICAgICAgPGRpdiBjbGFzcz1cInRpdGxlYmFyXCI+XG4gICAgICA8L2Rpdj5cblxuICAgICAgPGRpdiBjbGFzcz1cIm1ldGFkYXRhYmFyXCI+XG4gICAgICAgIDxzcGFuIGNsYXNzPVwibGFzdEVkaXRlZFwiPjwvc3Bhbj4gfFxuICAgICAgICA8c3BhbiBjbGFzcz1cIndvcmRzXCI+PC9zcGFuPiB8XG4gICAgICAgIDxzcGFuIGNsYXNzPVwiY2hhcnNcIj48L3NwYW4+XG4gICAgICA8L2Rpdj5cblxuICAgICAgPHRleHRhcmVhIGNsYXNzPVwiY29udGVudFwiPlxuICAgICAgPC90ZXh0YXJlYT5cbiAgICBgLFxuXG4gICAgZXZlbnRzOiB7XG4gICAgICAgICdjbGljayAubW9kZVN3aXRjaCc6ICdtb2RlU3dpdGNoJyxcbiAgICAgICAgJ2NsaWNrIC50aXRsZWJhcic6ICdzZXRUaXRsZSdcbiAgICB9LFxuXG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oYXR0cnMpIHtcbiAgICAgICAgdGhpcy5idXR0b25zZXQgPSBuZXcgTGlnYXR1cmUudmlld3MuTm90ZUJ1dHRvblNldCgpO1xuXG4gICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgfSxcblxuICAgIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuJGVsLmh0bWwodGhpcy50ZW1wbGF0ZSk7XG5cbiAgICAgICAgY29uc3QgYWN0aXZlTm90ZSA9IExpZ2F0dXJlLnZpZXdNYW5hZ2VyLmdldCgnYWN0aXZlTm90ZScpO1xuXG4gICAgICAgIHRoaXMuJCgnLnRpdGxlYmFyJykuaHRtbChhY3RpdmVOb3RlLmdldCgndGl0bGUnKSk7XG4gICAgICAgIHRoaXMuJCgnLmNvbnRlbnQnKS52YWwoYWN0aXZlTm90ZS5nZXQoJ2NvbnRlbnQnKSk7XG5cbiAgICAgICAgdGhpcy4kKCcubGFzdEVkaXRlZCcpLmh0bWwoYWN0aXZlTm90ZS5nZXQoJ3RpbWVzdGFtcCcpKTtcbiAgICAgICAgdGhpcy4kKCcud29yZHMnKS5odG1sKGFjdGl2ZU5vdGUuZ2V0KCdjb250ZW50Jykuc3BsaXQoJyAnKS5sZW5ndGgpO1xuICAgICAgICB0aGlzLiQoJy5jaGFycycpLmh0bWwoYWN0aXZlTm90ZS5nZXQoJ2NvbnRlbnQnKS5sZW5ndGgpO1xuXG4gICAgICAgIHRoaXMuJCgnLmJ1dHRvbnNldCcpLmh0bWwodGhpcy5idXR0b25zZXQucmVuZGVyKCkuJGVsKTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbn0pO1xuXG5MaWdhdHVyZS52aWV3cy5Nb2RhbCA9IEJhY2tib25lLlZpZXcuZXh0ZW5kKHtcblxuICAgIGlkOiAnbW9kYWwnLFxuXG4gICAgdGVtcGxhdGU6IGBcbiAgICAgIDxkaXYgY2xhc3M9XCJjb3B5XCI+XG4gICAgICA8L2Rpdj5cblxuICAgICAgPGlucHV0IGNsYXNzPVwibW9kYWxJbnB1dFwiPjwvaW5wdXQ+XG5cbiAgICAgIDxidXR0b24gY2xhc3M9XCJiYWRcIj5DYW5jZWw8L2J1dHRvbj5cbiAgICAgIDxidXR0b24gY2xhc3M9XCJnb29kXCI+T2s8L2J1dHRvbj5cbiAgICBgLFxuXG4gICAgZXZlbnRzOiB7XG4gICAgICAgICdjbGljayAuZ29vZCc6ICdnb29kQ2xpY2snLFxuICAgICAgICAnY2xpY2sgLmJhZCc6ICdiYWRDbGljaydcbiAgICB9LFxuXG4gICAgaW5pdGlhbGl6ZTogZnVuY3Rpb24oYXR0cnMpIHtcbiAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICB9LFxuXG4gICAgZ29vZENsaWNrOiBmdW5jdGlvbihldnQpIHtcblxuICAgIH0sXG5cbiAgICBiYWRDbGljazogZnVuY3Rpb24oZXZ0KSB7XG5cbiAgICB9LFxuXG4gICAgYWxlcnQ6IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblxuICAgIH0sXG5cbiAgICBjb25maXJtOiBmdW5jdGlvbihvcHRpb25zKSB7XG5cbiAgICB9LFxuXG4gICAgcHJvbXB0OiBmdW5jdGlvbihvcHRpb25zKSB7XG5cbiAgICB9LFxuXG4gICAgX2NhbGw6IGZ1bmN0aW9uKGNvcHksIHNob3dJbnB1dCwgc2hvd0JhZCwgZ29vZENhbGxiYWNrLCBiYWRDYWxsYmFjaykge1xuXG4gICAgfSxcblxuICAgIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuJGVsLmh0bWwodGhpcy50ZW1wbGF0ZSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxufSk7XG5cbkxpZ2F0dXJlLnZpZXdzLkFwcCA9IEJhY2tib25lLlZpZXcuZXh0ZW5kKHtcblxuICAgIHRlbXBsYXRlOiAnJyxcbiAgICBzaWRlYmFyOiBmYWxzZSxcbiAgICBlZGl0b3I6IGZhbHNlLFxuXG4gICAgZXZlbnRzOiB7fSxcblxuICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKGF0dHJzKSB7XG4gICAgICAgIHRoaXMuc2lkZWJhciA9IG5ldyBMaWdhdHVyZS52aWV3cy5TaWRlYmFyKCk7XG4gICAgICAgIHRoaXMuZWRpdG9yID0gbmV3IExpZ2F0dXJlLnZpZXdzLkVkaXRvcigpO1xuICAgICAgICB0aGlzLm1vZGFsID0gbmV3IExpZ2F0dXJlLnZpZXdzLk1vZGFsKCk7XG4gICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgfSxcblxuICAgIHJlbmRlcjogZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuJGVsLmh0bWwodGhpcy50ZW1wbGF0ZSk7XG4gICAgICAgIHRoaXMuJGVsLmFwcGVuZCh0aGlzLnNpZGViYXIucmVuZGVyKCkuJGVsKTtcbiAgICAgICAgdGhpcy4kZWwuYXBwZW5kKHRoaXMuZWRpdG9yLnJlbmRlcigpLiRlbCk7XG4gICAgICAgIHRoaXMuJGVsLmFwcGVuZCh0aGlzLm1vZGFsLnJlbmRlcigpLiRlbCk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG59KTtcbiIsIkxpZ2F0dXJlLlJvdXRlciA9IEJhY2tib25lLlJvdXRlci5leHRlbmQoe1xuICAgIC8vIHByb2JhYmx5IHdpbGwgY29tbXVuaWNhdGUgYSBsb3Qgd2l0aCBMaWdhdHVyZS5jb3JlXG59KTtcbiIsIkxpZ2F0dXJlLmluaXQgPSBmdW5jdGlvbigpIHtcblxuICAgIC8vIHNlcnZpY2VXb3JrZXIgY2hlY2sgLS0gZGlzYWJsZWQgZm9yIG5vd1xuICAgIC8vIGlmICgnc2VydmljZVdvcmtlcicgaW4gbmF2aWdhdG9yKSB7XG4gICAgLy8gICAgIG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLnJlZ2lzdGVyKCdzdy5qcycpLnRoZW4oZnVuY3Rpb24ocmVnaXN0cmF0aW9uKSB7XG4gICAgLy8gICAgICAgICBjb25zb2xlLmxvZygnU2VydmljZSB3b3JrZXIgcmVnaXN0cmF0aW9uIHN1Y2Nlc3NmdWwnKTtcbiAgICAvLyAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgLy8gICAgICAgICBjb25zb2xlLmVycm9yKCdTZXJ2aWNlIHdvcmtlciByZWdpc3RyYXRpb24gZmFpbGVkJywgZXJyKTtcbiAgICAvLyAgICAgfSk7XG4gICAgLy8gfVxuXG4gICAgLy8gaW5zdGFudGlhdGUgY29sbGVjdGlvbnNcbiAgICBMaWdhdHVyZS5vYmplY3RzLm5vdGVzID0gbmV3IExpZ2F0dXJlLmNvbGxlY3Rpb25zLk5vdGVDb2xsZWN0aW9uKCk7XG4gICAgTGlnYXR1cmUub2JqZWN0cy5ib29rcyA9IG5ldyBMaWdhdHVyZS5jb2xsZWN0aW9ucy5Cb29rQ29sbGVjdGlvbigpO1xuXG4gICAgLy8gaW5zdGFudGlhdGUgdmlld3NcbiAgICBMaWdhdHVyZS5zaW5nbGV0b25WaWV3cy5hcHAgPSBuZXcgTGlnYXR1cmUudmlld3MuQXBwKCk7XG4gICAgTGlnYXR1cmUuY29yZSA9IG5ldyBMaWdhdHVyZS52aWV3TWFuYWdlcigpO1xuXG4gICAgLy8gcm91dGVyXG4gICAgTGlnYXR1cmUucm91dGVyID0gbmV3IExpZ2F0dXJlLlJvdXRlcigpO1xuXG4gICAgLy8gYXR0YWNoIHZpZXdzXG4gICAgJChcIiNjb250ZW50XCIpLmFwcGVuZChMaWdhdHVyZS5zaW5nbGV0b25WaWV3cy5hcHAucmVuZGVyKCkuJGVsKTtcblxuICAgIC8vIGxvYWQgcXVlc3Rpb25zIGFuZCBjaG9pY2VzXG4gICAgTGlnYXR1cmUub2JqZWN0cy5ub3Rlcy5mZXRjaCgpO1xuXG4gICAgY29uc29sZS5pbmZvKCdMaWdhdHVyZSBpbml0aWFsaXplZCcpO1xuXG59O1xuXG5MaWdhdHVyZS5pbml0KCk7XG4iXX0=
